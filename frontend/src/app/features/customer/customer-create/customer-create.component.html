<div class="flex flex-col items-start bg-bg-gray min-h-screen">
  <!-- Header -->
  <div class="flex p-4 px-8 items-center gap-6 self-stretch bg-white">
    <div class="flex items-center gap-2.5 flex-1">
      <div class="flex items-start gap-4 flex-1">
        <button (click)="onBack()" class="w-6 h-6">
          <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15 6L9 12L15 18" stroke="#55596D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <div class="flex items-center gap-2 flex-1">
          <div class="flex flex-col justify-center items-start gap-2 flex-1">
            <h1 class="text-neutrals-900 font-bai-jamjuree text-21 font-bold">Create New Customer</h1>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="flex p-0 px-6 items-start gap-6 self-stretch">
    <form [formGroup]="customerForm" class="flex p-8 flex-col items-start gap-8 flex-1 rounded-xl border border-neutrals-50 bg-white shadow-panel">
      
      <!-- Customer Type and Tax ID Row -->
      <div class="flex items-start gap-8 self-stretch">
        <!-- Customer Type -->
        <div class="flex flex-col items-start gap-2 flex-1">
          <div class="flex items-end gap-2 self-stretch">
            <label class="flex-1 text-neutrals-900 font-bai-jamjuree text-base font-medium">
              Customer type<span class="text-red-500">*</span>
            </label>
          </div>
          <div class="flex h-11 items-start gap-11 self-stretch">
            <div class="flex items-center gap-2.5 self-stretch">
              <div class="flex p-0.5 justify-center items-center gap-2">
                <input 
                  type="radio" 
                  id="individual" 
                  value="individual" 
                  formControlName="customerType"
                  class="w-6 h-6 text-blue-600 focus:ring-blue-500">
              </div>
              <div class="flex flex-col justify-between items-start self-stretch">
                <label for="individual" class="text-black-500 font-bai-jamjuree text-sm font-medium cursor-pointer">Individual</label>
              </div>
            </div>
            <div class="flex items-center gap-2.5 self-stretch">
              <div class="flex p-0.5 justify-center items-center gap-2">
                <input 
                  type="radio" 
                  id="company" 
                  value="company" 
                  formControlName="customerType"
                  class="w-6 h-6 text-blue-600 focus:ring-blue-500">
              </div>
              <div class="flex flex-col justify-between items-start self-stretch">
                <label for="company" class="text-black-500 font-bai-jamjuree text-sm font-medium cursor-pointer">Company</label>
              </div>
            </div>
          </div>
        </div>

        <!-- Tax ID -->
        <div class="flex w-130 h-18 flex-col items-start gap-2">
          <div class="flex items-start gap-0.5">
            <label class="text-black-500 font-bai-jamjuree text-base font-medium">Tax ID</label>
          </div>
          <div class="flex flex-col justify-center items-start gap-1 self-stretch">
            <input 
              type="text" 
              formControlName="taxId"
              placeholder="Tax ID"
              class="flex p-2.5 px-3 justify-center items-center gap-2 self-stretch rounded-lg border border-neutrals-50 bg-white text-sm text-neutrals-300 font-bai-jamjuree focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
        </div>
      </div>

      <!-- Company Type - Only for Company -->
      <div *ngIf="isCompanyType()" class="flex flex-col items-start gap-2 self-stretch">
        <div class="flex items-end gap-2 self-stretch">
          <label class="flex-1 text-neutrals-900 font-bai-jamjuree text-base font-medium">
            Company type<span class="text-red-500">*</span>
          </label>
        </div>
        <div class="flex flex-col items-start gap-2 self-stretch">
          <div *ngFor="let type of companyTypes" class="flex h-11 items-center gap-2.5">
            <div class="flex p-0.5 justify-center items-center gap-2">
              <input
                type="radio"
                [id]="type.value"
                [value]="type.value"
                formControlName="companyType"
                class="w-6 h-6 text-blue-600 focus:ring-blue-500">
            </div>
            <div class="flex flex-col justify-between items-start self-stretch">
              <label [for]="type.value" class="text-black-500 font-bai-jamjuree text-sm font-medium cursor-pointer">{{ type.label }}</label>
            </div>
            <input
              *ngIf="type.value === 'others' && isCompanyTypeOthers()"
              type="text"
              formControlName="companyTypeOther"
              placeholder="Please Specify"
              class="flex flex-1 p-2.5 px-3 justify-center items-center gap-2 rounded-lg border border-neutrals-50 bg-neutrals-50 text-sm text-neutrals-300 font-bai-jamjuree focus:ring-2 focus:ring-blue-500">
          </div>
        </div>
      </div>

      <!-- Prefix - Only for Individual -->
      <div *ngIf="isIndividualType()" class="flex flex-col items-start gap-2 self-stretch">
        <div class="flex items-end gap-2 self-stretch">
          <label class="flex-1 text-neutrals-900 font-bai-jamjuree text-base font-medium">
            Prefix<span class="text-red-500">*</span>
          </label>
        </div>
        <div class="flex justify-between items-start self-stretch">
          <div class="flex items-center gap-2.5 self-stretch">
            <div class="flex p-0.5 justify-center items-center gap-2">
              <input
                type="radio"
                id="mr"
                value="mr"
                formControlName="prefix"
                class="w-6 h-6 text-blue-600 focus:ring-blue-500">
            </div>
            <label for="mr" class="text-black-500 font-bai-jamjuree text-sm font-medium cursor-pointer">Mr.</label>
          </div>
          <div class="flex items-center gap-2.5 self-stretch">
            <div class="flex p-0.5 justify-center items-center gap-2">
              <input
                type="radio"
                id="mrs"
                value="mrs"
                formControlName="prefix"
                class="w-6 h-6 text-blue-600 focus:ring-blue-500">
            </div>
            <label for="mrs" class="text-black-500 font-bai-jamjuree text-sm font-medium cursor-pointer">Mrs.</label>
          </div>
          <div class="flex items-center gap-2.5 self-stretch">
            <div class="flex p-0.5 justify-center items-center gap-2">
              <input
                type="radio"
                id="ms"
                value="ms"
                formControlName="prefix"
                class="w-6 h-6 text-blue-600 focus:ring-blue-500">
            </div>
            <label for="ms" class="text-black-500 font-bai-jamjuree text-sm font-medium cursor-pointer">Ms.</label>
          </div>
          <div class="flex items-center gap-2">
            <div class="flex p-0.5 justify-center items-center gap-2">
              <input
                type="radio"
                id="others-prefix"
                value="others"
                formControlName="prefix"
                class="w-6 h-6 text-blue-600 focus:ring-blue-500">
            </div>
            <label for="others-prefix" class="text-black-500 font-bai-jamjuree text-sm font-medium cursor-pointer">Others</label>
            <input
              *ngIf="isPrefixOthers()"
              type="text"
              formControlName="customPrefix"
              placeholder="Please Specify"
              class="flex w-130 p-2.5 px-3 justify-center items-center gap-2 rounded-lg border border-neutrals-50 bg-neutrals-50 text-sm text-neutrals-300 font-bai-jamjuree focus:ring-2 focus:ring-blue-500">
          </div>
        </div>
      </div>

      <!-- Company Name - Only for Company -->
      <div *ngIf="isCompanyType()" class="flex h-18 flex-col items-start gap-2 self-stretch">
        <div class="flex items-start gap-0.5">
          <label class="text-black-500 font-bai-jamjuree text-base font-medium">Company name</label>
          <span class="text-red-500 font-bai-jamjuree text-base font-medium">*</span>
        </div>
        <div class="flex flex-col justify-center items-start gap-1 self-stretch">
          <input
            type="text"
            formControlName="companyName"
            placeholder="Company Name"
            class="flex p-2.5 px-3 justify-center items-center gap-2 self-stretch rounded-lg border border-neutrals-50 bg-white text-sm text-neutrals-300 font-bai-jamjuree focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        </div>
      </div>

      <!-- First Name and Last Name Row - Only for Individual -->
      <div *ngIf="isIndividualType()" class="flex items-start gap-5 self-stretch">
        <div class="flex flex-col items-start gap-2 flex-1">
          <div class="flex items-start gap-0.5">
            <label class="text-black-500 font-bai-jamjuree text-base font-medium">First Name</label>
            <span class="text-red-500 font-bai-jamjuree text-base font-medium">*</span>
          </div>
          <div class="flex flex-col justify-center items-start gap-1 self-stretch">
            <input
              type="text"
              formControlName="firstName"
              placeholder="First Name"
              class="flex p-2.5 px-3 justify-center items-center gap-2 self-stretch rounded-lg border border-neutrals-50 bg-white text-sm text-neutrals-300 font-bai-jamjuree focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
        </div>
        <div class="flex flex-col items-start gap-2 flex-1">
          <div class="flex items-start gap-0.5">
            <label class="text-black-500 font-bai-jamjuree text-base font-medium">Last Name</label>
            <span class="text-red-500 font-bai-jamjuree text-base font-medium">*</span>
          </div>
          <div class="flex flex-col justify-center items-start gap-1 self-stretch">
            <input
              type="text"
              formControlName="lastName"
              placeholder="Last Name"
              class="flex p-2.5 px-3 justify-center items-center gap-2 self-stretch rounded-lg border border-neutrals-50 bg-white text-sm text-neutrals-300 font-bai-jamjuree focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
        </div>
      </div>

      <!-- Email and Phone Number Row -->
      <div class="flex items-start gap-5 self-stretch">
        <div class="flex flex-col items-start gap-2 flex-1">
          <div class="flex items-start gap-0.5">
            <label class="text-black-500 font-bai-jamjuree text-base font-medium">Email</label>
            <span class="text-red-500 font-bai-jamjuree text-base font-medium">*</span>
          </div>
          <div class="flex flex-col justify-center items-start gap-1 self-stretch">
            <input 
              type="email" 
              formControlName="email"
              placeholder="Email"
              class="flex p-2.5 px-3 justify-center items-center gap-2 self-stretch rounded-lg border border-neutrals-50 bg-white text-sm text-neutrals-300 font-bai-jamjuree focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
        </div>
        <div class="flex w-130 h-18 flex-col items-start gap-2">
          <div class="flex items-start gap-0.5">
            <label class="text-black-500 font-bai-jamjuree text-base font-medium">Phone no.</label>
            <span *ngIf="isCompanyType()" class="text-red-500 font-bai-jamjuree text-base font-medium">*</span>
          </div>
          <div class="flex flex-col justify-center items-start gap-1 self-stretch">
            <input 
              type="tel" 
              formControlName="phoneNo"
              placeholder="Phone No."
              class="flex p-2.5 px-3 justify-center items-center gap-2 self-stretch rounded-lg border border-neutrals-50 bg-white text-sm text-neutrals-300 font-bai-jamjuree focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
        </div>
      </div>

      <!-- Contact Persons Section -->
      <div class="flex flex-col items-start gap-2 self-stretch">
        <div class="flex items-start gap-0.5">
          <label class="text-black-500 font-bai-jamjuree text-base font-medium">Contact persons</label>
          <span class="text-red-500 font-bai-jamjuree text-base font-medium">*</span>
        </div>
        
        <!-- Contact Persons Table -->
        <div class="flex flex-col items-start self-stretch rounded-lg" formArrayName="contactPersons">
          <div class="flex items-start self-stretch">
            <!-- Table Headers -->
            <div class="flex flex-col items-start">
              <!-- No. Column Header -->
              <div class="flex h-11 p-0 px-2.5 flex-col justify-center items-center gap-1 self-stretch bg-gray-100">
                <div class="text-primary-teal text-center font-bai-jamjuree text-sm font-semibold">No.</div>
              </div>
              <!-- Row Numbers -->
              <div *ngFor="let contact of contactPersons.controls; let i = index"
                   class="flex h-15 p-0 px-2.5 items-center gap-1 self-stretch"
                   [class.bg-bg-gray]="i % 2 === 1"
                   [class.bg-white]="i % 2 === 0">
                <div class="flex w-6 p-1.25 px-2.25 justify-center items-center">
                  <svg class="w-2 h-3.25 flex-shrink-0" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1.5 2C1.77614 2 2 1.77614 2 1.5C2 1.22386 1.77614 1 1.5 1C1.22386 1 1 1.22386 1 1.5C1 1.77614 1.22386 2 1.5 2Z" fill="#55596D" stroke="#55596D" stroke-width="1.5"/>
                    <path d="M1.5 7C1.77614 7 2 6.77614 2 6.5C2 6.22386 1.77614 6 1.5 6C1.22386 6 1 6.22386 1 6.5C1 6.77614 1.22386 7 1.5 7Z" fill="#55596D" stroke="#55596D" stroke-width="1.5"/>
                    <path d="M1.5 12C1.77614 12 2 11.7761 2 11.5C2 11.2239 1.77614 11 1.5 11C1.22386 11 1 11.2239 1 11.5C1 11.7761 1.22386 12 1.5 12Z" fill="#55596D" stroke="#55596D" stroke-width="1.5"/>
                    <path d="M6.5 2C6.77614 2 7 1.77614 7 1.5C7 1.22386 6.77614 1 6.5 1C6.22386 1 6 1.22386 6 1.5C6 1.77614 6.22386 2 6.5 2Z" fill="#55596D" stroke="#55596D" stroke-width="1.5"/>
                    <path d="M6.5 7C6.77614 7 7 6.77614 7 6.5C7 6.22386 6.77614 6 6.5 6C6.22386 6 6 6.22386 6 6.5C6 6.77614 6.22386 7 6.5 7Z" fill="#55596D" stroke="#55596D" stroke-width="1.5"/>
                    <path d="M6.5 12C6.77614 12 7 11.7761 7 11.5C7 11.2239 6.77614 11 6.5 11C6.22386 11 6 11.2239 6 11.5C6 11.7761 6.22386 12 6.5 12Z" fill="#55596D" stroke="#55596D" stroke-width="1.5"/>
                  </svg>
                </div>
                <div class="w-4.5 text-black-500 text-center font-bai-jamjuree text-sm font-normal">{{ i + 1 }}</div>
              </div>
            </div>

            <!-- Contact Name Column -->
            <div class="flex flex-col items-start flex-1">
              <div class="flex h-11 p-0 px-2.5 flex-col justify-center items-center gap-1 self-stretch bg-gray-100">
                <div class="flex justify-center items-center gap-0.5">
                  <div class="text-primary-teal text-center font-bai-jamjuree text-sm font-semibold">Contact name</div>
                  <span class="text-red-500 font-bai-jamjuree text-base font-medium">*</span>
                </div>
              </div>
              <div *ngFor="let contact of contactPersons.controls; let i = index"
                   class="flex h-15 p-0 px-2.5 flex-col justify-center items-start gap-1 self-stretch"
                   [class.bg-bg-gray]="i % 2 === 1"
                   [class.bg-white]="i % 2 === 0">
                <div class="flex h-11 flex-col justify-center items-start gap-1 flex-shrink-0 self-stretch" [formGroupName]="i">
                  <input
                    type="text"
                    formControlName="contactName"
                    placeholder="Contact name"
                    class="flex p-3 justify-center items-center gap-2 flex-1 self-stretch rounded-lg border border-neutrals-50 bg-white text-sm font-bai-jamjuree text-neutrals-100 focus:ring-2 focus:ring-blue-500">
                </div>
              </div>
            </div>

            <!-- Email Column -->
            <div class="flex flex-col items-start flex-1">
              <div class="flex h-11 p-0 px-2.5 flex-col justify-center items-center gap-1 self-stretch bg-gray-100">
                <div class="flex justify-center items-center gap-0.5">
                  <div class="text-primary-teal text-center font-bai-jamjuree text-sm font-semibold">Email</div>
                  <span class="text-red-500 font-bai-jamjuree text-base font-medium">*</span>
                </div>
              </div>
              <div *ngFor="let contact of contactPersons.controls; let i = index"
                   class="flex h-15 p-0 px-2.5 flex-col justify-center items-start gap-1 self-stretch"
                   [class.bg-bg-gray]="i % 2 === 1"
                   [class.bg-white]="i % 2 === 0">
                <div class="flex h-11 flex-col justify-center items-start gap-1 flex-shrink-0 self-stretch" [formGroupName]="i">
                  <input
                    type="email"
                    formControlName="email"
                    placeholder="Email address"
                    class="flex p-3 justify-center items-center gap-2 flex-1 self-stretch rounded-lg border border-neutrals-50 bg-white text-sm font-bai-jamjuree text-neutrals-100 focus:ring-2 focus:ring-blue-500">
                </div>
              </div>
            </div>

            <!-- Remarks Column -->
            <div class="flex flex-col items-start flex-1">
              <div class="flex h-11 p-0 px-2.5 flex-col justify-center items-center gap-1 self-stretch bg-gray-100">
                <div class="text-primary-teal text-center font-bai-jamjuree text-sm font-semibold">Remarks</div>
              </div>
              <div *ngFor="let contact of contactPersons.controls; let i = index"
                   class="flex h-15 p-0 px-2.5 flex-col justify-center items-start gap-1 self-stretch"
                   [class.bg-bg-gray]="i % 2 === 1"
                   [class.bg-white]="i % 2 === 0">
                <div class="flex h-11 flex-col justify-center items-start gap-1 flex-shrink-0 self-stretch" [formGroupName]="i">
                  <input
                    type="text"
                    formControlName="remarks"
                    placeholder="Remarks"
                    class="flex p-3 justify-center items-center gap-2 flex-1 self-stretch rounded-lg border border-neutrals-50 bg-white text-sm font-bai-jamjuree text-neutrals-100 focus:ring-2 focus:ring-blue-500">
                </div>
              </div>
            </div>

            <!-- Withholding Tax Column - Only for Company -->
            <div *ngIf="isCompanyType()" class="flex w-15 flex-col items-start">
              <div class="flex w-15 h-11 p-0 px-2.5 flex-col justify-center items-center gap-1 bg-gray-100">
                <div class="text-primary-teal text-center font-bai-jamjuree text-sm font-semibold">Withholding Tax (%)</div>
              </div>
              <div *ngFor="let contact of contactPersons.controls; let i = index"
                   class="flex h-15 p-0 px-2.5 flex-col justify-center items-center gap-1 self-stretch"
                   [class.bg-bg-gray]="i % 2 === 1"
                   [class.bg-white]="i % 2 === 0">
                <div class="flex h-11 flex-col justify-center items-start gap-1 flex-shrink-0 self-stretch" [formGroupName]="i">
                  <input
                    *ngIf="contactPersons.at(i).get('withholdingTax')"
                    type="number"
                    formControlName="withholdingTax"
                    min="0"
                    max="100"
                    step="0.01"
                    placeholder="0"
                    class="flex p-3 justify-center items-center gap-2 flex-1 self-stretch rounded-lg border border-neutrals-50 bg-white text-sm font-bai-jamjuree text-neutrals-100 focus:ring-2 focus:ring-blue-500 text-center">
                </div>
              </div>
            </div>

            <!-- Actions Column -->
            <div class="flex w-12.5 flex-col items-start">
              <div class="flex w-15 h-11 p-0 px-2.5 flex-col justify-center items-center gap-1 bg-gray-100">
                <div class="text-primary-teal text-center font-bai-jamjuree text-sm font-semibold">Action</div>
              </div>
              <div *ngFor="let contact of contactPersons.controls; let i = index"
                   class="flex h-15 p-0 px-2.5 flex-col justify-center items-center gap-1 self-stretch"
                   [class.bg-bg-gray]="i % 2 === 1"
                   [class.bg-white]="i % 2 === 0">
                <button
                  *ngIf="contactPersons.length > 1"
                  type="button"
                  (click)="removeContactPerson(i)"
                  class="w-6 h-6 flex-shrink-0">
                  <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 9L18.005 20.3463C17.8369 21.3026 17.0062 22 16.0353 22H7.96474C6.99379 22 6.1631 21.3026 5.99496 20.3463L4 9" stroke="#E8294D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M21 6H15.375M3 6H8.625M8.625 6V4C8.625 2.89543 9.52043 2 10.625 2H13.375C14.4796 2 15.375 2.89543 15.375 4V6M8.625 6H15.375" stroke="#E8294D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          
          <!-- Add Contact Person Button -->
          <div class="flex p-3.5 items-start gap-245.5 self-stretch bg-primary-teal-light">
            <button 
              type="button"
              (click)="addContactPerson()"
              class="flex w-11 h-11 flex-col items-start">
              <div class="flex p-2.5 flex-col justify-center items-center gap-2 flex-1 self-stretch rounded-lg bg-primary-teal">
                <svg class="w-5 h-5" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M5 10H10M15 10H10M10 10V5M10 10V15" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </button>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex justify-end items-center gap-2 self-stretch">
        <button 
          type="button"
          (click)="onCancel()"
          class="flex items-start">
          <div class="flex h-11 p-2.5 px-4 items-center gap-2 rounded-lg bg-blue-50">
            <div class="text-blue-600 text-center font-bai-jamjuree text-base font-semibold">Cancel</div>
          </div>
        </button>
        <button 
          type="button"
          (click)="onSave()"
          [disabled]="!isFormValid"
          class="flex items-start"
          [class.opacity-50]="!isFormValid">
          <div class="flex h-11 p-2.5 px-4 items-center gap-2 rounded-lg"
               [class.bg-neutrals-50]="!isFormValid"
               [class.bg-primary-teal]="isFormValid">
            <div class="text-center font-bai-jamjuree text-base font-semibold"
                 [class.text-neutrals-100]="!isFormValid"
                 [class.text-white]="isFormValid">Save</div>
          </div>
        </button>
      </div>
    </form>
  </div>
</div>
